/*! For license information please see download.Lcs4c7rug.js.LICENSE.txt */
!function(){const e=PRHelper.getType(),t=PRHelper.getHTML(),l=PRHelper.getSetting(),r=PRHelper.getRequest(),o=PRFrontendHelper.getHTML();let a=t.getElement("#progress_bar"),n=t.getElement("#message_wrapper");const s=e=>{t.isElement(a)&&PRHelper.getHTML().addAttribute(a,{"aria-valuenow":e,style:{width:`${e}%`}})},i=()=>{let e=a.closest(".overlay");if(t.isElement(e)){let a=t.getElement(".download",e);s(95),r.ajax(l.getOption("ajax.get_url")).onSuccess((e=>{s(100);let l=t.getElement(".download-link");t.updateAttribute(l,{href:e.url}),t.addAttribute(a,{class:"show"})})).onError((e=>{o.alert(n,e.message??e)})).onFinally((()=>{t.removeAttribute(".progress-bar",{class:"show"}),t.removeAttribute(e,{class:"overlay"})})).addNonce().send({file:PRHelper.getServer().getParam("file")})}};let g=l.getOption("wait",0),d=PRHelper.getServer().getParam("file");if(PRHelper.getHook().on("click",(function(e,l){t.addClass(l,"disabled")}),".download-link"),g>0){const t=(e,t=1)=>Math.floor(Math.random()*(e-t)+t),r=e=>{let l,r,o={},a=Math.floor(100/e),n=a,s=1,i=g;r=t(g/(e-1)),o[0]=r;for(let d=0;d<e-2;d++)i-=r,s=n,n+=a,l=t(n,s),r=t(g/(e-1)),o[l]=r;return o[100]=i-r,o};let a,p=0,m=r(Math.min(8,g));if(e.isEmpty(d))o.alert(n,l.getOption("message.file_not_found"));else for(let e in m)a=m[e],setTimeout((()=>{100==e?i():e<95&&s(e)}),1e3*(a+p)),p+=a}else i()}();