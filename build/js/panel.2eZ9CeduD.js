(()=>{"use strict";const t="fetchTeam",e="joinToTeam",a="checkTeamCode",r="fetchTeamMetadata",n="fetchTeamJoinFields",s="setTeam",i="setTeamManager",o="setTeamMetadata",l="setTeamProducers",c="setTeamJoinFields",m="/pmpr/v1/content/team",d={[r]({commit:t,state:e},a){return new Promise(((a,r)=>{null!==e.metadata?a(e.metadata):this._vm.$api.$get(`${m}/get-metadata`).then((e=>{t(o,e.data),a(e.data)})).catch((t=>{r(t)}))}))},[t]({commit:t,state:e},a){return new Promise(((r,n)=>{null!==e.team?r(e.team):this._vm.$api.$get(`${m}/get`,{params:a}).then((e=>{t(s,e.data),r(e.data)})).catch((({response:t})=>{n(t)}))}))},[e]({commit:t},e){return new Promise(((t,a)=>{this._vm.$api.$post(`${m}/join`,e).then((e=>{t(e.data)})).catch((({response:t})=>{a(t)}))}))},[a]({commit:t},e){return new Promise(((t,a)=>{this._vm.$api.$post(`${m}/check-code`,e).then((e=>{t(e.data)})).catch((({response:t})=>{a(t)}))}))},fetchTeamManager({commit:t},e){return new Promise(((a,r)=>{this._vm.$api.$get(`${m}/get-manager`,{params:e}).then((e=>{t(i,e.data),a(e.data)})).catch((({response:t})=>{r(t)}))}))},fetchTeamProducers({commit:t},e){return new Promise(((a,r)=>{this._vm.$api.$get(`${m}/get-producers`,{params:e}).then((e=>{t(l,e.data),a(e.data)})).catch((({response:t})=>{r(t)}))}))},[n]({commit:t},e){return new Promise(((a,r)=>{this._vm.$api.$get(`${m}/get-join-fields`,{params:e}).then((e=>{t(c,e.data),a(e.data)})).catch((({response:t})=>{r(t)}))}))}},f={[s](t,e){t.team=e},[o](t,e){t.metadata=e},[i](t,e){t.manager=e},[l](t,e){t.producers=e},[c](t,e){t.joinFields=e}},u={state:{team:null,manager:null,producers:null,joinFields:[],metadata:null},actions:d,mutations:f},h="fetchTraffic",p="setTraffic",_={[h]({commit:t,state:e},a){return new Promise(((r,n)=>{const{period:s,type:i,id:o}=a;void 0!==e.traffic[i]&&void 0!==e.traffic[i][s]&&void 0!==e.traffic[i][s][o]?r(e.traffic[i][s][o]):this._vm.$api.$get(`/pmpr/v1/content/performance/get-${s}-traffic`,{params:{type:i,id:o}}).then((e=>{t(p,{period:s,type:i,id:o,traffic:e.data}),r(e.data)})).catch((t=>{n(t)}))}))}},v={[p](t,e){const{period:a,type:r,id:n,traffic:s}=e;void 0===t.traffic[r]&&(t.traffic[r]={}),void 0===t.traffic[r][a]&&(t.traffic[r][a]={}),t.traffic[r][a][n]=s}},g={state:{traffic:{post:{},team:{},request:{}}},actions:_,mutations:v};PRHelper.getHook().addFilter("panel_store_modules",(t=>(t["filefox-team"]=u,t["filefox-performance"]=g,t)),500);var b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.loading?a("PanelSpinner"):t.fields?a("b-row",{staticClass:"justify-content-center h-100 align-items-center"},[a("b-col",{attrs:{sm:"12",md:"8",lg:"12",xl:"8"}},[a("PanelCard",{attrs:{has_header:!1,loading:t.submitting},scopedSlots:t._u([{key:"body",fn:function(){return[a("div",{staticClass:"d-flex flex-column justify-content-center"},["check_code"===t.formState?a("PanelForm",{attrs:{fields:t.fields,labelAlign:"left",id:"check_code",data:t.data,tag:"div",offset:"4",inline:!1},on:{changed:function(e){return t.data=e}},scopedSlots:t._u([{key:"custom",fn:function(e){var r=e.field;e.props;return["message"===r.id?a("PanelNotice",{staticClass:"text-center",attrs:{icon:!1,content:r.description,type:"primary"}}):t._e()]}}],null,!1,2304994019)}):"join_team"===t.formState?a("b-row",[a("b-col",{staticClass:"mb-4 mb-md-0",attrs:{md:"6"}},[a("h3",{staticClass:"mb-4"},[t._v(t._s(t.teamData.title))]),t._v(" "),a("div",{domProps:{innerHTML:t._s(t.teamData.description)}})]),t._v(" "),a("b-col",{attrs:{md:"6"}},[t.teamData.identifies.items?a("PanelCard",{attrs:{has_header:!1,attrs:{container:{class:"bg-gray-200 mb-4"},body:{class:"px-6 pb-3 pt-6"}}},scopedSlots:t._u([{key:"body",fn:function(){return[a("h4",[t._v(t._s(t.teamData.identifies.title))]),t._v(" "),a("ul",{staticClass:"list-group list-group-flush bg-transparent"},t._l(t.teamData.identifies.items,(function(e,r){return a("li",{key:r,staticClass:"list-group-item px-0 border-gray-500 bg-transparent"},[a("b-row",[a("b-col",{attrs:{cols:"5"}},[t._v(t._s(e.title))]),t._v(" "),a("b-col",{attrs:{cols:"7"}},[void 0!==e.value?a("strong",[t._v("\n                            "+t._s(e.value)+"\n                          ")]):a("div",{domProps:{innerHTML:t._s(e.content)}})])],1)],1)})),0)]},proxy:!0}],null,!1,1854028508)}):t._e()],1),t._v(" "),a("b-col",{attrs:{cols:"12"}},[t.teamData.activities.items?a("PanelCard",{attrs:{has_header:!1,attrs:{container:{class:"bg-gray-200"},body:{class:"px-6 pb-3 pt-6"}}},scopedSlots:t._u([{key:"body",fn:function(){return[a("h4",[t._v(t._s(t.teamData.activities.title))]),t._v(" "),a("ul",{staticClass:"list-group list-group-flush bg-transparent"},t._l(t.teamData.activities.items,(function(e,r){return a("li",{key:r,staticClass:"list-group-item px-0 border-gray-400 bg-transparent"},[a("b-row",[a("b-col",{attrs:{cols:"5"}},[t._v(t._s(e.title))]),t._v(" "),a("b-col",{attrs:{cols:"7"}},[void 0!==e.value?a("strong",[t._v("\n                            "+t._s(e.value)+"\n                          ")]):a("div",{domProps:{innerHTML:t._s(e.content)}})])],1)],1)})),0)]},proxy:!0}],null,!1,3510661565)}):t._e()],1)],1):t._e(),t._v(" "),a("PanelModalActions",{attrs:{submitActionProps:{name:"join_submit",text:t.formSubmitText},"show-cancel":"join_team"===t.formState},on:{canceled:t.onCancel,submitted:t.onSubmitForm}})],1)]},proxy:!0}])})],1)],1):t.team?a("router-view",{attrs:{team:t.team,request:t.request}}):t._e()};b._withStripped=!0;const y={name:"PanelContentProduction",data:()=>({data:null,team:null,fields:null,request:null,loading:!0,teamData:null,formState:"check_code",submitting:!1}),beforeMount(){this.$store.dispatch(t).then((({team:t,request:e})=>{t&&e&&(this.team=t,this.request=e,this.loading=!1)})).catch((t=>{this.$store.dispatch(n).then((t=>{this.fields=t.data,this.loading=!1})).catch((()=>{}))}))},computed:{formSubmitText(){let t="";return t="check_code"===this.formState?this.translate("filefox.action.check_code"):this.translate("filefox.action.join_team"),t}},methods:{onCancel(){this.formState="check_code"},onSubmitForm(){this.submitting=!0,"check_code"===this.formState?this.$helper.$runAction(a,this.data).then((({response:t,modal:e})=>{this.teamData=t,this.formState="join_team"})).finally((()=>this.submitting=!1)):"join_team"===this.formState&&this.$helper.$runAction(e,this.data).then((({response:t,modal:e})=>{e.then((()=>{PRHelper.getTool().reload()}))}))}}};function C(t,e,a,r,n,s,i,o){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=a,c._compiled=!0),r&&(c.functional=!0),s&&(c._scopeId="data-v-"+s),i?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=l):n&&(l=o?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(c.functional){c._injectStyles=l;var m=c.render;c.render=function(t,e){return l.call(e),m(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:t,options:c}}const x=C(y,b,[],!1,null,null,null).exports;var P=function(){var t=this,e=t.$createElement;return(t._self._c||e)("PanelSidebar",{attrs:{tabs:t.tabs,args:{team:t.team}}})};P._withStripped=!0;const w=C({name:"PanelContentPerformance",props:{team:null},computed:{tabs(){return this.$router.getRouteChildren("panel_content_performance")}}},P,[],!1,null,null,null).exports;var $=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.team?a("PanelCard",{scopedSlots:t._u([{key:"body",fn:function(){return[t.metadata&&t.trafficChartData?a("div",[a("PanelCard",{staticClass:"bg-gray-200 mb-8",attrs:{has_header:!1},scopedSlots:t._u([{key:"body",fn:function(){return[a("b-row",[a("b-col",{staticClass:"mb-4 mb-lg-0",attrs:{md:"12",xl:"7"}},[a("ul",{staticClass:"list-group list-group-flush bg-transparent my-auto list-group-simple"},t._l(t.metadata.items,(function(e,r){return a("li",{key:r,staticClass:"list-group-item px-0 border-gray-400 py-3 d-flex justify-content-between bg-transparent"},[a("span",{staticClass:"my-auto"},[t._v(t._s(e.title))]),t._v(" "),a("strong",{staticClass:"fk-none fs-3"},[t._v(t._s(t.formatedNumber(e.value)))])])})),0)]),t._v(" "),a("b-col",{staticClass:"mb-4 mb-lg-0",attrs:{md:"12",xl:"5"}},[a("PanelCard",{staticClass:"bg-primary text-white",attrs:{has_header:!1,attrs:{body:{class:"p-3"}}},scopedSlots:t._u([{key:"body",fn:function(){return[a("div",{staticClass:"d-flex flex-column text-center my-auto"},[a("span",[t._v(t._s(t.metadata.result.suffix_text))]),t._v(" "),a("strong",{staticClass:"my-2 fs-xxl fk-none"},[t._v(t._s(t.percentage(t.formatedNumber(t.metadata.result.text))))]),t._v(" "),a("span",[t._v(t._s(t.metadata.result.postfix_text))])])]},proxy:!0}],null,!1,216201946)})],1)],1)]},proxy:!0}],null,!1,1857507318)}),t._v(" "),a("PanelNav",{staticClass:"mb-4",attrs:{items:t.navItems,pills:!0,active:t.view},on:{"nav-changed":function(e){return t.onNavChange(e)}}}),t._v(" "),t.chartLoading?a("PanelSpinner"):a("div",[t.trafficChartData?a("PanelBarChart",{attrs:{height:350,"data-labels":!1,extra:t.chartOptions,yaxis:t.trafficChartYaxis,xaxis:t.trafficChartXaxis,series:t.trafficChartSeries}}):t._e()],1)],1):a("PanelSpinner")]},proxy:!0}],null,!1,3817202571)}):t._e()};$._withStripped=!0;const S=C({name:"PanelContentPerformanceMe",props:{team:null,request:null},data:()=>({view:"monthly",loading:!0,metadata:null,chartLoading:!0,trafficChartData:null}),beforeMount(){this.fetchTraffic(!1),this.$store.dispatch(r).then((t=>{this.metadata=t}))},computed:{navItems(){return[{name:"monthly",title:this.translate("filefox.chart.monthly")},{name:"weekly",title:this.translate("filefox.chart.weekly")},{name:"daily",title:this.translate("filefox.chart.daily")}]},trafficChartSeries(){return[{name:this.translate("filefox.chart.team_traffic"),data:this.trafficChartData?.data}]},trafficChartXaxis(){return{categories:this.trafficChartData?.labels,reversed:!0,labels:{align:"right",style:{direction:"rtl"},formatter:function(t){return PRHelper.getI18n().number(t)}}}},trafficChartYaxis(){return{title:{text:this.translate("filefox.chart.team_aggregated_traffic"),offsetX:-10},labels:{show:!0,formatter:function(t){return PRHelper.getI18n().formatedNumber(t)}}}},chartOptions:()=>({tooltip:{y:{formatter:function(t){return PRHelper.getI18n().formatedNumber(t)}}}})},methods:{onNavChange(t){this.view=t,this.fetchTraffic(!0)},fetchTraffic(t){return t&&(this.chartLoading=!0),this.$store.dispatch(h,{period:this.view,type:"team",id:this.team}).then((t=>{this.trafficChartData=t})).finally((()=>{this.chartLoading=!1}))}}},$,[],!1,null,null,null).exports;var T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.team?a("PanelDatatableCard",{attrs:{columns:t.columns,remote:t.remoteProps},scopedSlots:t._u([{key:"td",fn:function(e){var r=e.item,n=(e.column,e.column_key);e.id;return[a("PanelCellText",{attrs:{text:t.prepareCellOutput(r[n])}})]}}],null,!1,2743060710)}):t._e()};T._withStripped=!0;const k=C({name:"PanelContentPerformanceTeam",props:{team:null},methods:{prepareCellOutput(t){return"number"==typeof t&&(t=this.formatedNumber(t)),t}},computed:{remoteProps(){return{api:"/pmpr/v1/content/team/get-producers","query-params":{team:this.team,sort:"accepted_at",sortBy:"orderBy"}}},columns(){return{user:{title:this.translate("filefox.column.user"),width:"20%"},accepted_at:{title:this.translate("filefox.column.join_date"),width:"20%"},post_count:{title:this.translate("filefox.column.post_count"),width:"20%"},all_traffic:{title:this.translate("filefox.column.all_traffic"),width:"20%"},last_month_traffic:{title:this.translate("filefox.column.last_month_traffic"),width:"20%"}}}}},T,[],!1,null,null,null).exports;var D=function(){var t=this.$createElement;return(this._self._c||t)("router-view")};D._withStripped=!0;const j=C({name:"PanelContentManagement"},D,[],!1,null,null,null).exports;window.PanelContent=x,window.PanelContentPerformance=w,window.PanelContentPerformanceMe=S,window.PanelContentPerformanceTeam=k,window.PanelContentManagement=j})();